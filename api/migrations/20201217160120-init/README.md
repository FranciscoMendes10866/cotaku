# Migration `20201217160120-init`

This migration has been generated by FranciscoMendes10866 at 12/17/2020, 5:01:20 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "User" (
    "id" TEXT NOT NULL,
    "email" TEXT NOT NULL,
    "password" TEXT NOT NULL,
    "username" TEXT NOT NULL,
    "is_online" BOOLEAN NOT NULL DEFAULT true,
    "is_admin" BOOLEAN NOT NULL DEFAULT false,

    PRIMARY KEY ("id")
)

CREATE TABLE "Anime" (
    "id" TEXT NOT NULL,
    "profile" TEXT NOT NULL,
    "cover" TEXT NOT NULL,
    "name" TEXT NOT NULL,
    "synopsis" TEXT NOT NULL,
    "status" TEXT NOT NULL DEFAULT E'Finished',
    "format" TEXT NOT NULL DEFAULT E'TV',
    "duration" INTEGER NOT NULL DEFAULT 24,
    "season" TEXT NOT NULL,
    "source" TEXT NOT NULL DEFAULT E'Manga',
    "gender" TEXT NOT NULL,
    "author_id" TEXT NOT NULL,

    PRIMARY KEY ("id")
)

CREATE TABLE "Review" (
    "id" TEXT NOT NULL,
    "content" TEXT NOT NULL,
    "anime_id" TEXT NOT NULL,
    "user_id" TEXT NOT NULL,

    PRIMARY KEY ("id")
)

CREATE UNIQUE INDEX "User.email_unique" ON "User"("email")

CREATE UNIQUE INDEX "User.username_unique" ON "User"("username")

CREATE UNIQUE INDEX "Anime.profile_unique" ON "Anime"("profile")

CREATE UNIQUE INDEX "Anime.cover_unique" ON "Anime"("cover")

CREATE UNIQUE INDEX "Anime.name_unique" ON "Anime"("name")

ALTER TABLE "Anime" ADD FOREIGN KEY("author_id")REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "Review" ADD FOREIGN KEY("anime_id")REFERENCES "Anime"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "Review" ADD FOREIGN KEY("user_id")REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20201217160120-init
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,45 @@
+datasource db {
+    provider = "postgresql"
+    url = "***"
+}
+
+generator db {
+    provider = "go run github.com/prisma/prisma-client-go"
+}
+
+model User {
+    id        String   @id @default(uuid())
+    email     String   @unique
+    password  String
+    username  String   @unique
+    is_online Boolean  @default(true)
+    is_admin  Boolean  @default(false)
+    Review    Review[]
+    Anime     Anime[]
+}
+
+model Anime {
+    id        String   @id @default(uuid())
+    profile   String   @unique
+    cover     String   @unique
+    name      String   @unique
+    synopsis  String
+    status    String   @default("Finished")
+    format    String   @default("TV")
+    duration  Int      @default(24)
+    season    String
+    source    String   @default("Manga")
+    gender    String
+    User      User     @relation(fields: [author_id], references: [id])
+    author_id String
+    Review    Review[]
+}
+
+model Review {
+    id       String @id @default(uuid())
+    content  String
+    Anime    Anime  @relation(fields: [anime_id], references: [id])
+    anime_id String
+    User     User   @relation(fields: [user_id], references: [id])
+    user_id  String
+}
```


